jQuery(document).ready(function(o){var a=o("#ekb-admin-page-wrap"),c=!1,t=!1;function e(){a.find("[id*=_search_terms]").prop("readonly",!0),o("[id*=-search-kb]").prop("disabled",!0),o("#epkb-main-page-container").find("a").on("click",function(e){e.preventDefault()}),o("#eckb-article-page-container").find("a").on("click",function(e){e.preventDefault()}),o(".epkb-navigation-button").attr("onclick","").unbind("click")}function i(){o(".eckb-no-kb-template-message").remove();var e=o(".epkb-archive-page-template-config");"kb_templates"===a.find("#templates_for_kb input[name=templates_for_kb]:checked").val()?(a.find(e).show(),a.find("#eckb-mm-arch-links-setup-list section").show(),a.find("#eckb-mm-arch-links-alltext-list section").show(),o(".eckb-no-kb-template-message").remove()):(a.find("#eckb-mm-arch-links-setup-list").append('<p class="eckb-no-kb-template-message">'+epkb_vars.archive_page+"</p>"),a.find("#eckb-mm-arch-links-setup-list section").hide(),a.find("#eckb-mm-arch-links-alltext-list section").hide())}o("#epkb-main-page-content").bind("main_content_changed",function(){v(),d(),e()}),o("#epkb-article-page-content").bind("article_content_changed",function(){e(),d()}),i(),o("#epkb-list-of-kbs").on("change",function(e){var a=o(this).find(":selected").data("kb-admin-url");a&&(window.location.href=a)}),o("#epkb-config-main-info").find(".page-icon").on("click",function(){i(),o(".eckb-bottom-notice-message").html(""),o(".option-info-icon").removeClass("active-info"),o(".option-info-content").addClass("hidden"),o("#epkb-main-page").show(),o("#epkb-article-page").show(),o(".epkb-info-section").removeClass("epkb-active-page"),o(this).parent().parent().toggleClass("epkb-active-page"),o(".epkb-config-content").hide(),o(".epkb-config-sidebar").removeClass("open-menu"),o("#epkb-article-page-settings").hide(),o("#epkb-main-page-settings").hide(),o(".config-option-group").removeClass("epkb-mm-active"),o(".epkb-mega-menu-toggle").show();var e=o(this).attr("id"),a=o("#kb_article_page_layout input[name=kb_article_page_layout]:checked").val();if(r.page_switching(e),o("#"+e+"-content").fadeToggle(),"epkb-main-page"==e)o("#epkb-main-page-settings").show(),o(".epkb-info-save").show(),o(".epkb-demo-data-button").show(),d(),o("#epkb-main-page-content").show(),"kb_templates"==o("#templates_for_kb input[name=templates_for_kb]:checked").val()&&o(".eckb-mm-mp-links-setup-main-template-content").addClass("epkb-mm-active"),c&&"Sidebar"==a&&(t=!(c=!1),h("main_page",u()),t=!1);else if("epkb-article-page"==e){"kb_templates"==o("#templates_for_kb input[name=templates_for_kb]:checked").val()&&o(".eckb-mm-mp-links-setup-article-template-content").addClass("epkb-mm-active"),o("#epkb-article-page-settings").show(),o(".epkb-info-save").show(),o(".epkb-demo-data-button").show(),d(),0===o("#epkb-article-page-content").html().trim().length&&k("layout",a),o("#epkb-article-page-content").show(),c&&"Sidebar"==a&&h("article_page",m()),c="Article"==a&&c}else"epkb-archive-page"==e?o(".epkb-info-save").show():(o(".epkb-info-save").hide(),o(".epkb-mega-menu-toggle").hide(),o(".epkb-demo-data-button").hide())}),o(".epkb-demo-data-button").on("click",".ep_font_icon_info",function(){o(this).toggleClass("active-info"),o(".epkb-demo-info-content").toggleClass("hidden")});var r={general:function(){o("#epkb-config-main-info .epkb-setting-icon").on("click",function(){o(this).parent().parent().toggleClass("epkb-active-page")}),o("#epkb-admin-mega-menu").on("click",".epkb-mm-sidebar li",function(){o(".epkb-mm-sidebar li").removeClass("epkb-mm-active"),o(".epkb-mm-links li").removeClass("active-link"),o(this).addClass("epkb-mm-active"),o(".epkb-mm-content .epkb-mm-links").removeClass("epkb-mm-active"),o(".config-option-group").removeClass("epkb-mm-active");var e=o(this).attr("id");if(o(".epkb-mm-content").find("#"+e+"-list").addClass("epkb-mm-active"),"eckb-mm-mp-links-organize"==e)o(".eckb-mm-mp-links-organize--organize-content").addClass("epkb-mm-active"),o("#epkb-config-ordering-sidebar").show();else if("eckb-mm-ap-links-organize"==e)o(".eckb-mm-ap-links-organize--organize-content").addClass("epkb-mm-active"),o("#epkb-config-article-ordering-sidebar").show();else if("eckb-mm-mp-links-setup"==e){"kb_templates"==o("#templates_for_kb input[name=templates_for_kb]:checked").val()&&o(".eckb-mm-mp-links-setup-main-template-content").addClass("epkb-mm-active")}d()}),o("#epkb-admin-mega-menu").on("click",".epkb-mm-links li",function(){var e=o(this).parents(".epkb-mm-links").attr("id");if("eckb-mm-mp-links-setup-list"!==e&&"eckb-mm-ap-links-setup-list"!==e){o(".epkb-mm-links li").removeClass("active-link"),o(this).addClass("active-link"),o(".config-option-group").removeClass("epkb-mm-active");var a=o(this).attr("id");o(".epkb-config-sidebar").find("."+a+"-content").addClass("epkb-mm-active")}}),o("#epkb-admin-mega-menu").on("click",".epkb-close-mm",function(){o(".epkb-open-mm").show(),o("#epkb-admin-mega-menu").slideUp(600)}),o(".epkb-open-mm").on("click",function(){o(this).hide(),o("#epkb-admin-mega-menu").slideDown(600)}),o("#epkb-admin-mega-menu").on("click","#templates_for_kb_group",function(){i(),o(".config-option-group").removeClass("epkb-mm-active"),"kb_templates"==o("#templates_for_kb input[name=templates_for_kb]:checked").val()&&o(".eckb-mm-mp-links-setup-main-template-content").addClass("epkb-mm-active")})},page_switching:function(e){return o(".epkb-open-mm").hide(),"epkb-main-page"===e?(j("show"),o(".epkb-mm-links").removeClass("epkb-mm-active"),o("#eckb-mm-mp-links").show(),o("#eckb-mm-ap-links").hide(),o("#eckb-mm-arch-links").hide(),o("#eckb-mm-mp-links li").removeClass("epkb-mm-active"),o("#eckb-mm-mp-links-setup").addClass("epkb-mm-active"),o("#eckb-mm-mp-links-setup-list").addClass("epkb-mm-active"),o("#eckb-mm-ap-links-setup-list").removeClass("epkb-mm-active")):"epkb-article-page"===e?(j("show"),o(".epkb-mm-links").removeClass("epkb-mm-active"),o("#eckb-mm-ap-links").show(),o("#eckb-mm-mp-links").hide(),o("#eckb-mm-arch-links").hide(),o("#eckb-mm-ap-links li").removeClass("epkb-mm-active"),o("#eckb-mm-ap-links-setup").addClass("epkb-mm-active"),o("#eckb-mm-ap-links-setup-list").addClass("epkb-mm-active"),o("#eckb-mm-mp-links-setup-list").removeClass("epkb-mm-active")):"epkb-config-overview"===e?o("#epkb-admin-mega-menu").hide():"epkb-archive-page"===e&&(j("show"),o(".epkb-mm-links").removeClass("epkb-mm-active"),o("#eckb-mm-arch-links li").removeClass("epkb-mm-active"),o("#eckb-mm-arch-links-setup-list").addClass("epkb-mm-active"),o("#eckb-mm-arch-links-setup").addClass("epkb-mm-active"),o("#eckb-mm-arch-links").show(),o("#eckb-mm-ap-links").hide(),o("#eckb-mm-mp-links").hide()),this},drag_drop:function(){o("#epkb-admin-mega-menu").on("click","#eckb-mm-mp-links-organize, #eckb-mm-ap-links-organize",function(){o(".epkb-section-container").animate({backgroundColor:"#00ff00"},1).animate({backgroundColor:"#ffffff"},1500),o(".epkb-nav-tabs").animate({backgroundColor:"#00ff00"},1).animate({backgroundColor:"#ffffff"},1500),o(".epkb-panel-container ").animate({backgroundColor:"#00ff00"},1).animate({backgroundColor:"#ffffff"},1500),o(".eckb-categories-list").animate({backgroundColor:"#00ff00"},1).animate({backgroundColor:"#ffffff"},1500),o(".sidebar-sections").animate({backgroundColor:"#00ff00"},1).animate({backgroundColor:"#ffffff"},1500)})}};r.general(),r.drag_drop(),o("#epkb_cancel_config, #epkb_cancel_dashboard").on("click",function(){location.reload()}),o("#epkb-main-page-button").hasClass("epkb-active-page")||o("#epkb-article-page-button").hasClass("epkb-active-page")?o(".epkb-info-save").show():o(".epkb-demo-data-button").hide(),o("#templates_for_kb_group").find(":radio").on("click",function(){w(o(this))}),o("[id*=-search-toggle]").on("click",function(){o("#epkb-article-page-content").find("[id*=-search-toggle]").slideToggle()}),o("#ekb-admin-page-wrap").find("[id*=_search_terms]").prop("readonly",!0),o("[id*=-search-kb]").prop("disabled",!0),o("#kb_name").on("keyup",function(){var e=25-o(this).val().length;o("#character_value").remove(),e<0&&o(this).after('<div id="character_value" class="input_error"><p>'+epkb_vars.reduce_name_size+"</p></div>")}),a.on("click",".epkb-info",function(){o(this).parent().toggleClass("epkb-preview-active-info"),o(this).parent().find(".epkb-preview-information").slideToggle(),o(this).parent().next().css("opacity",".2"),o(this).parent().hasClass("epkb-preview-active-info")||o(this).parent().next().css("opacity","1")});var n=0;function p(){var i,a=o("#epkb-article-page-button").hasClass("epkb-active-page"),e={action:"epkb_change_one_config_param_ajax",epkb_kb_id:o("#epkb_kb_id").val(),form:o("#epkb-config-config").serialize(),epkb_demo_kb:o("#epkb-layout-preview-data").is(":checked"),epkb_is_article_icon_active:a};o.ajax({type:"POST",dataType:"json",data:e,url:ajaxurl,beforeSend:function(e){o("#epkb-ajax-in-progress").text(epkb_vars.updating_preview).dialog("open")}}).done(function(e){(e=e||"").error||void 0===e.message||void 0===e.kb_info_panel_output?i=e.message?e.message:C("",epkb_vars.reload_try_again,"error"):a?(o("#epkb-article-page-content").html(e.kb_info_panel_output),o("#epkb-article-page-content").trigger("article_content_changed")):(o("#epkb-main-page-content").html(e.kb_info_panel_output),o("#epkb-main-page-content").trigger("main_content_changed"))}).fail(function(e,a,t){i=t?" ["+t+"]":epkb_vars.unknown_error,i=C(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,i,"error")}).always(function(){o("#epkb-ajax-in-progress").dialog("close"),i&&(o(".eckb-bottom-notice-message").replaceWith(i),o("html, body").animate({scrollTop:0},"slow"))})}o("#epkb-config-config").on("change",function(e){void 0!==e.target.id&&(e.target.id.includes("reset_style")||e.target.id.match("^categories_display_sequence")||e.target.id.match("^articles_display_sequence")||e.target.id.match("^epkb-layout-preview-data")||e.target.id.match("^kb_main_page_layout")||e.target.id.match("^kb_article_page_layout")||e.target.id.match("grid_category_icon*")||e.target.id.match("article_common_path*")||e.target.id.match("kb_articles_common_path")||0===e.target.id.indexOf("section_head_category_icon")&&"section_head_category_icon_location"!==e.target.id&&"section_head_category_icon_size"!==e.target.id)||(e.preventDefault(),e.stopPropagation(),clearTimeout(n),n=setTimeout(function(){p()},3e3))});var s;function l(){o(".wp-picker-container").on("click",function(){o(".epkb-picker-preview").remove(),o(this).find(".iris-picker-inner").before('<div class="epkb-picker-preview">'+epkb_vars.preview+"</div>")}),o(".wp-picker-container").on("click",".epkb-picker-preview",function(e){e.preventDefault(),e.stopPropagation();var i,a=o("#epkb-article-page-button").hasClass("epkb-active-page"),t={action:"epkb_change_one_config_param_ajax",epkb_kb_id:o("#epkb_kb_id").val(),form:o("#epkb-config-config").serialize(),epkb_demo_kb:o("#epkb-layout-preview-data").is(":checked"),epkb_is_article_icon_active:a};o.ajax({type:"POST",dataType:"json",data:t,url:ajaxurl,beforeSend:function(e){o("#epkb-ajax-in-progress").text(epkb_vars.updating_preview).dialog("open")}}).done(function(e){(e=e||"").error||void 0===e.message||void 0===e.kb_info_panel_output?i=e.message?e.message:C("",epkb_vars.reload_try_again,"error"):a?(o("#epkb-article-page-content").html(e.kb_info_panel_output),o("#epkb-article-page-content").trigger("article_content_changed")):(o("#epkb-main-page-content").html(e.kb_info_panel_output),o("#epkb-main-page-content").trigger("main_content_changed"))}).fail(function(e,a,t){i=t?" ["+t+"]":epkb_vars.unknown_error,i=C(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,i,"error")}).always(function(){o("#epkb-ajax-in-progress").dialog("close"),i&&(o(".eckb-bottom-notice-message").replaceWith(i),o("html, body").animate({scrollTop:0},"slow"))})})}function b(a,e){var i,t={action:"epkb_change_main_page_config_ajax",epkb_kb_id:o("#epkb_kb_id").val(),target_type:a,target_name:e,epkb_chosen_main_page_layout:o("#kb_main_page_layout input[name=kb_main_page_layout]:checked").val(),epkb_demo_kb:o("#epkb-layout-preview-data").is(":checked"),form:o("#epkb-config-config").serialize()};o.ajax({type:"POST",dataType:"json",data:t,url:ajaxurl,beforeSend:function(e){o("#epkb-ajax-in-progress").text(epkb_vars.changing_config).dialog("open")}}).done(function(e){(e=e||"").error||void 0===e.message||void 0===e.style_tab_output||void 0===e.colors_tab_output||void 0===e.kb_main_page_output?i=e.message?e.message:C("",epkb_vars.reload_try_again,"error"):(i=e.message,o("#epkb-main-page-content").html(e.kb_main_page_output),o("#epkb-main-page-content").trigger("main_content_changed"),"layout"==a&&(o("#epkb-admin-mega-menu").html(e.kb_mega_menu),r.page_switching("epkb-main-page"),o("#epkb-article-page-content").html(e.article_page_output),o("#epkb-article-page-content").trigger("article_content_changed"),e.ordering_output&&o("#epkb-config-ordering-sidebar").replaceWith(e.ordering_output),e.overview_page_output&&o("#epkb-config-overview-content").html(e.overview_page_output),e.main_page_text_output&&o("#epkb-config-text-sidebar").replaceWith(e.main_page_text_output),_(!1,a,e.article_page_layout,e)),"NONE"!=e.style_tab_output&&o("#epkb-config-styles-sidebar").replaceWith(e.style_tab_output),"NONE"!=e.colors_tab_output&&o("#epkb-config-colors-sidebar").replaceWith(e.colors_tab_output),"advanced_search_box_style"==a&&o("#epkb-config-text-sidebar").replaceWith(e.main_page_text_output))}).fail(function(e,a,t){i=t?" ["+t+"]":epkb_vars.unknown_error,i=C(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,i,"error")}).always(function(){o("#epkb-ajax-in-progress").dialog("close");var e=!1;0==o("#epkb-config-colors-sidebar .wp-picker-container").length&&(o("#epkb-config-colors-sidebar .ekb-color-picker input").wpColorPicker(),e=!0),0==o("#epkb-config-article-colors-sidebar .wp-picker-container").length&&(o("#epkb-config-article-colors-sidebar .ekb-color-picker input").wpColorPicker(),e=!0),e&&l(),i&&(o(".eckb-bottom-notice-message").replaceWith(i),o("html, body").animate({scrollTop:0},"slow"))})}function k(t,i){var n,e={action:"epkb_change_article_page_config_ajax",epkb_kb_id:o("#epkb_kb_id").val(),target_type:t,target_name:i,epkb_chosen_main_page_layout:o("#kb_main_page_layout input[name=kb_main_page_layout]:checked").val(),epkb_chosen_article_page_layout:o("#kb_article_page_layout input[name=kb_article_page_layout]:checked").val(),epkb_demo_kb:o("#epkb-layout-preview-data").is(":checked"),form:o("#epkb-config-config").serialize()};o.ajax({type:"POST",dataType:"json",data:e,url:ajaxurl,beforeSend:function(e){o("#epkb-ajax-in-progress").text(epkb_vars.changing_config).dialog("open")}}).done(function(e){var a=_(!0,t,i,e);n=0<a.length?a:e.message}).fail(function(e,a,t){n=t?" ["+t+"]":epkb_vars.unknown_error,n=C(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,n,"error")}).always(function(){o("#epkb-ajax-in-progress").dialog("close"),0==o("#epkb-config-article-colors-sidebar .wp-picker-container").length&&(o("#epkb-config-article-colors-sidebar .ekb-color-picker input").wpColorPicker(),l()),n&&(o(".eckb-bottom-notice-message").replaceWith(n),o("html, body").animate({scrollTop:0},"slow"))})}function _(e,a,t,i){if((i=i||"").error||void 0===i.message||void 0===i.article_style_tab_output||void 0===i.article_colors_tab_output)return i.message?i.message:C("",epkb_vars.reload_try_again,"error");"NONE"!=i.kb_mega_menu&&e&&(o("#epkb-admin-mega-menu").html(i.kb_mega_menu),r.page_switching("epkb-article-page")),o("#epkb-article-page-content").html(i.article_page_output),o("#epkb-article-page-content").trigger("article_content_changed"),"NONE"!=i.article_style_tab_output&&o("#epkb-config-article-styles-sidebar").replaceWith(i.article_style_tab_output),"NONE"!=i.article_ordering_output&&o("#epkb-config-article-ordering-sidebar").replaceWith(i.article_ordering_output),"NONE"!=i.article_colors_tab_output&&o("#epkb-config-article-colors-sidebar").replaceWith(i.article_colors_tab_output),"NONE"!=i.article_text_tab_output&&o("#epkb-config-article-text-sidebar").replaceWith(i.article_text_tab_output),i.article_general_tab_output&&o("#epkb-config-article-general-sidebar").replaceWith(i.article_general_tab_output),"advanced_search_box_style"==a&&o("#epkb-config-text-sidebar").replaceWith(i.main_page_text_output);var n=o("#kb_article_page_layout input[name=kb_article_page_layout]:checked").val();return c&&"Sidebar"==n&&h("article_page",m()),c=!1,""}function d(){var e;e=!(o("#epkb-main-page-button").hasClass("epkb-active-page")&&o("#eckb-mm-mp-links-organize").hasClass("epkb-mm-active")||o("#epkb-article-page-button").hasClass("epkb-active-page")&&o("#eckb-mm-ap-links-organize").hasClass("epkb-mm-active")),o(".epkb-config-content .epkb-top-categories-list").sortable({axis:"x",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder",update:function(e,a){g(),h("main_page",m())}}),o(".epkb-config-content .eckb-categories-list").sortable({axis:"x,y",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder",update:function(e,a){g()}}),o(".epkb-config-content .eckb-sub-category-ordering").sortable({axis:"x,y",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder",update:function(e,a){g()}}),o(".epkb-config-content .eckb-sub-sub-category-ordering").sortable({axis:"x,y",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder",update:function(e,a){g()}}),o(".epkb-config-content .eckb-articles-ordering, .eckb-articles-ordering").sortable({axis:"y",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder",update:function(e,a){c=!0,o("#epkb-main-page").closest(".epkb-info-pages").hasClass("epkb-active-page")?o("#epkb-config-ordering-sidebar").find("input[name=articles_display_sequence][value=user-sequenced]").click():o("#epkb-article-page").closest(".epkb-info-pages").hasClass("epkb-active-page")&&o("#epkb-config-article-ordering-sidebar").find("input[name=articles_display_sequence][value=user-sequenced]").click()}}),o(".epkb-config-content .epkb-top-categories-list").sortable("option","disabled",e),o(".epkb-config-content .eckb-categories-list").sortable("option","disabled",e),o(".epkb-config-content .eckb-sub-category-ordering").sortable("option","disabled",e),o(".epkb-config-content .eckb-sub-sub-category-ordering").sortable("option","disabled",e),o(".epkb-config-content .eckb-articles-ordering").sortable("option","disabled",e);var a=e?"auto":"move";o("#epkb-content-container").css("cursor",a,"important"),o(".epkb-config-content").find("a").css("cursor",a,"important")}function g(){c=!0,o("#epkb-main-page").closest(".epkb-info-pages").hasClass("epkb-active-page")?o("#epkb-config-ordering-sidebar").find("input[name=categories_display_sequence][value=user-sequenced]").click():o("#epkb-article-page").closest(".epkb-info-pages").hasClass("epkb-active-page")&&o("#epkb-config-article-ordering-sidebar").find("input[name=categories_display_sequence][value=user-sequenced]").click()}function m(){var n="";return o("#epkb-main-page-content").find("[data-kb-type]").each(function(e,a){var t=o(this).data("kb-top-category-id")?o(this).data("kb-top-category-id"):"";if(t&&(n+="xx"+t+"xcategory"),void 0!==o(this).attr("data-kb-type")&&"top-category-no-articles"==o(this).attr("data-kb-type"))return!0;var i=void 0===o(this).data("kb-category-id")?o(this).data("kb-article-id"):o(this).data("kb-category-id");void 0!==i&&(n+="xx"+i+"x"+o(this).attr("data-kb-type"))}),n}function u(){var n="";return o("#epkb-article-page-content").find("[data-kb-type]").each(function(e,a){var t=o(this).data("kb-top-category-id")?o(this).data("kb-top-category-id"):"";t&&(n+="xx"+t+"xcategory");var i=void 0===o(this).data("kb-category-id")?o(this).data("kb-article-id"):o(this).data("kb-category-id");void 0!==i&&(n+="xx"+i+"x"+o(this).attr("data-kb-type"))}),n}function f(){var i="",e=o("#kb_article_page_layout input[name=kb_article_page_layout]:checked").val(),a=!("Tabs"!==o("#kb_main_page_layout input[name=kb_main_page_layout]:checked").val()||t||o("#epkb-article-page-button").hasClass("epkb-active-page")&&"Sidebar"===e);return t=!1,a&&void 0!==o(".epkb-top-categories-list")&&(o(".epkb-top-categories-list").children().each(function(e,a){var t=o(this).find("[data-kb-category-id]").data("kb-category-id");t&&(i+="xx"+t)}),c=!0),i}function h(a,e){if(0!=e.length){var i,t={action:"epkb_change_article_category_sequence",_wpnonce_epkb_save_kb_config:o("#_wpnonce_epkb_save_kb_config").val(),epkb_kb_id:o("#epkb_kb_id").val(),form:o("#epkb-config-config, #epkb-config-config2").serialize(),page_type:a,articles_sequence_new_value:x("articles_display_sequence","articles_display_sequence"),categories_sequence_new_value:x("categories_display_sequence","categories_display_sequence"),epkb_new_sequence:e,epkb_chosen_main_page_layout:o("#kb_main_page_layout input[name=kb_main_page_layout]:checked").val(),epkb_demo_kb:o("#epkb-layout-preview-data").is(":checked"),top_cat_sequence:f()};o.ajax({type:"POST",dataType:"json",data:t,url:ajaxurl,beforeSend:function(e){o("#epkb-ajax-in-progress").text(epkb_vars.switching_article_seq).dialog("open")}}).done(function(e){(e=e||"").error||void 0===e.message||void 0===e.kb_page_output?i=e.message?e.message:C("",epkb_vars.reload_try_again,"error"):(i=e.message,"main_page"==a?(o("#epkb-main-page-content").html(e.kb_page_output),o("#epkb-main-page-content").trigger("main_content_changed")):(o("#epkb-article-page-content").html(e.kb_page_output),o("#epkb-article-page-content").trigger("article_content_changed")))}).fail(function(e,a,t){i=t?" ["+t+"]":epkb_vars.unknown_error,i=C(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,i,"error")}).always(function(){o("#epkb-ajax-in-progress").dialog("close"),i&&(o(".eckb-bottom-notice-message").replaceWith(i),o("html, body").animate({scrollTop:0},"slow"))})}}function v(){var e=o(".epkb-nav-tabs li"),a=0;o("#epkb-content-container").find(e).each(function(){var e=o(this).outerHeight(!0);a<e&&(a=e)}),o("#epkb-content-container").find(e).css("min-height",a)}function y(e){"no_icons"===e?(o("#epkb-main-page-settings").find("#section_head_category_icon_group").hide(),o("#epkb-main-page-settings").find("#section_head_category_icon_size_group").hide()):(o("#epkb-main-page-settings").find("#section_head_category_icon_group").show(),o("#epkb-main-page-settings").find("#section_head_category_icon_size_group").show())}function w(e){e.parents(".radio-buttons-vertical").find(".input_container").removeClass("checked-radio"),e.attr("checked")&&e.parent().addClass("checked-radio")}function C(e,a,t){return'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+t+'">'+(e?"<h4>"+e+"</h4>":"")+(a||"")+'</span></div><div class="epkb-close-notice epkbfa epkbfa-window-close"></div></div>'}function x(e,a){var t={};return o.each(o("input[id^="+e+"]").serializeArray(),function(e,a){t[a.name]=a.value}),void 0===t[a]?"":t[a]}function j(e){"show"===e&&o("#epkb-admin-mega-menu").css("display","flex"),"hide"===e&&o("#epkb-admin-mega-menu").css("display","none")}o(".ekb-color-picker input").wpColorPicker({done:function(e,a){},clear:function(){}}),l(),o(".epkb-config-sidebar").find(":radio").on("click",function(){w(o(this))}),e(),o(".epkb-sidebar-container").on("click",".option-info-icon",function(e){e.preventDefault();var a=o(this).parents(".config-option-group").find(".option-info-content").hasClass("hidden");o(".option-info-icon").removeClass("active-info"),o(".option-info-content").addClass("hidden");var t=o(this).parents(".epkb-sidebar-container").position();a&&(o(this).addClass("active-info"),o(this).parents(".config-option-group").find(".option-info-content").removeClass("hidden"),o(this).parents(".config-option-group").find(".option-info-content").css({top:t.top+30,right:o(".epkb-sidebar-container").outerWidth(!0)+20}))}),o("#epkb-config-main-info").on("change","#epkb-layout-preview-data",function(e){e.preventDefault(),b("demo","demo"),k("demo","demo")}),o("#epkb-admin-mega-menu").on("change","#kb_main_page_layout :input",function(e){e.preventDefault(),c=!1,o("#kb_main_page_layout").val(e.target.value);var a=e.target.value;o("#kb_main_page_layout input[name=kb_main_page_layout]").blur(),"Grid"===a?o("#kb_main_page_category_link_group").show():o("#kb_main_page_category_link_group").hide(),b("layout",a)}),o("#epkb-admin-mega-menu").on("change","#main_page_reset_style :input",function(e){e.preventDefault();var a=e.target.value;o("#main_page_reset_style input[name=main_page_reset_style]").prop("checked",!1),b("style",a)}),o("#epkb-admin-mega-menu").on("change","#main_page_reset_search_box_style :input",function(e){e.preventDefault();var a=e.target.value;o("#main_page_reset_search_box_style input[name=main_page_reset_search_box_style]").prop("checked",!1),b("advanced_search_box_style",a)}),o("#epkb-admin-mega-menu").on("click","#main_page_reset_colors :button",function(e){e.preventDefault();var a=e.target.value;o("#main_page_reset_colors input[name=reset_colors]").prop("checked",!1),b("colors",a)}),o("body").on("change","#kb_article_page_layout_group",function(e){e.preventDefault();var a=e.target.value;o("#kb_article_page_layout").val(e.target.value),o(".config-option-group").removeClass("epkb-mm-active"),o("#kb_article_page_layout input[name=kb_article_page_layout]").blur(),k("layout",a)}),o("body").on("change","#article_page_reset_style :input",function(e){e.preventDefault();var a=e.target.value;o("#article_page_reset_style input[name=article_page_reset_style]").prop("checked",!1),k("style",a)}),o("body").on("change","#article_page_reset_search_box_style :input",function(e){e.preventDefault();var a=e.target.value;o("#article_page_reset_search_box_style input[name=article_page_reset_search_box_style]").prop("checked",!1),k("advanced_search_box_style",a)}),o("body").on("click","#article_page_reset_colors :button",function(e){e.preventDefault();var a=e.target.value;o("#reset_colors input[name=reset_colors]").prop("checked",!1),k("colors",a)}),o("body").on("click",".epkb_art_common_path_button",function(e){o("#epkb_common_path_changed").val("yes")}),o("#epkb_save_kb_config, #epkb_save_dashboard").on("click",function(e){e.preventDefault();var i="",a=o("#kb_article_page_layout input[name=kb_article_page_layout]:checked").val(),t=o("#epkb-article-page-button").hasClass("epkb-active-page")&&"Sidebar"===a?u():m(),n={action:"epkb_save_kb_config_changes",_wpnonce_epkb_save_kb_config:o("#_wpnonce_epkb_save_kb_config").val(),epkb_kb_id:o("#epkb_kb_id").val(),form:o("#epkb-config-config, #epkb-config-config2, #epkb-config-config3").serialize(),epkb_new_sequence:t,top_cat_sequence:f()};o.ajax({type:"POST",dataType:"json",data:n,url:ajaxurl,beforeSend:function(e){o("#epkb-ajax-in-progress").text(epkb_vars.save_config).dialog("open")}}).done(function(e){if((e=e||"").error||void 0===e.message)i=e.message?e.message:C("",epkb_vars.reload_try_again,"error");else if(i=e.message,o("#epkb-content-container").find(".epkb-sortable-item-highlight").each(function(e,a){o(this).removeClass("epkb-sortable-item-highlight")}),0<=i.indexOf("RELOAD")){o(".eckb-bottom-notice-message").replaceWith(i),i="",o("html, body").animate({scrollTop:0},"slow"),window.setTimeout(function(){location.reload()},2e3)}}).fail(function(e,a,t){i=t?" ["+t+"]":epkb_vars.unknown_error,i=C(epkb_vars.not_saved+" "+epkb_vars.msg_try_again,i,"error")}).always(function(){o("#epkb-ajax-in-progress").dialog("close"),i&&(o(".eckb-bottom-notice-message").replaceWith(i),o("html, body").animate({scrollTop:0},"slow"))})}),o("#epkb_save_wpml_settings").on("click",function(e){e.preventDefault();var i="",a={action:"epkb_save_wpml_settings",_wpnonce_epkb_save_wpml_settings:o("#_wpnonce_epkb_save_wpml_settings").val(),epkb_kb_id:o("#epkb_kb_id").val(),epkb_wpml_is_enabled:o("#epkb_wpml_is_enabled").is(":checked")};o.ajax({type:"POST",dataType:"json",data:a,url:ajaxurl,beforeSend:function(e){o("#epkb-ajax-in-progress").text(epkb_vars.save_config).dialog("open")}}).done(function(e){i=(e=e||"").error||void 0===e.message?e.message?e.message:C("",epkb_vars.reload_try_again,"error"):e.message}).fail(function(e,a,t){i=t?" ["+t+"]":epkb_vars.unknown_error,i=C(epkb_vars.not_saved+" "+epkb_vars.msg_try_again,i,"error")}).always(function(){o("#epkb-ajax-in-progress").dialog("close"),i&&(o(".eckb-bottom-notice-message").replaceWith(i),o("html, body").animate({scrollTop:0},"slow"))})}),o("#epkb-main-page-settings").on("change","#articles_display_sequence",function(e){e.preventDefault(),h("main_page",m())}),o("#epkb-article-page-settings").on("change","#articles_display_sequence",function(e){e.preventDefault(),h("article_page",u())}),o("#epkb-main-page-settings").on("change","#categories_display_sequence",function(e){e.preventDefault(),h("main_page",m())}),o("#epkb-article-page-settings").on("change","#categories_display_sequence",function(e){e.preventDefault(),h("article_page",u())}),v(),o("#epkb-config-main-info").on("click",".epkb-info-pages",function(){v()}),o("#epkb-main-page-content").on("click",".epkb_top_categories",function(){o(this).parent().find("li").removeClass("active"),o(this).addClass("active"),o("#epkb-main-page-container").find(".epkb-tab-panel").removeClass("active"),o(".epkb-panel-container .epkb-tab-panel:nth-child("+(o(this).index()+1)+")").addClass("active")}),o("#epkb-main-page-content").on("click",".epkb-section-body .epkb-category-level-2-3",function(){var a=o(this).find("i");function e(e){a.hasClass(e[0])?(a.removeClass(e[0]),a.addClass(e[1])):a.hasClass(e[1])&&(a.removeClass(e[1]),a.addClass(e[0]))}e(["ep_font_icon_plus","ep_font_icon_minus"]),e(["ep_font_icon_plus_box","ep_font_icon_minus_box"]),e(["ep_font_icon_right_arrow","ep_font_icon_down_arrow"]),e(["ep_font_icon_arrow_carrot_right","ep_font_icon_arrow_carrot_down"]),e(["ep_font_icon_arrow_carrot_right_circle","ep_font_icon_arrow_carrot_down_circle"]),e(["ep_font_icon_folder_add","ep_font_icon_folder_open"])}),o("#epkb-main-page-content").on("click",".epkb-section-body .epkb-category-level-2-3",function(){o(this).next().toggleClass("active")}),o("#epkb-main-page-content").on("click",".epkb-show-all-articles",function(){o(this).toggleClass("active");var e=o(this).parent("ul").find("li");o(this).hasClass("active")?(o(this).find(".epkb-show-text").addClass("epkb-hide-elem"),o(this).find(".epkb-hide-text").removeClass("epkb-hide-elem")):(o(this).find(".epkb-show-text").removeClass("epkb-hide-elem"),o(this).find(".epkb-hide-text").addClass("epkb-hide-elem")),o(e).each(function(){o(this).hasClass("epkb-hide-elem")?(o(this).removeClass("epkb-hide-elem"),o(this).addClass("visible")):o(this).hasClass("visible")&&(o(this).removeClass("visible"),o(this).addClass("epkb-hide-elem"))})}),o("#epkb-main-page-settings").on("change","#section_head_category_icon_location",function(){o("#section_head_category_icon_group").find("input").attr("checked","unchecked"),y(o(this).val())}),y(o("#section_head_category_icon_location").val()),o("[id$=pkb-main-page-content]").on("click",".epkb-top-category-box",function(){if(o("[id$=pkb-config-styles-sidebar]").is(":visible")){o(".epkb-top-category-box").removeClass("epkb-category-selection-color"),o(this).addClass("epkb-category-selection-color"),o("#epkb-content-container").find("[id^=section_head_category_icon]").attr("disabled",!1),o(".epkb-config-category-name").html("<strong>"+o(this).find(".epkb-cat-name").text()+"</strong>");var e=o(this).find(".epkb-cat-icon").attr("data-kb-category-icon");o("#section_head_category_icon_group").find("input[value="+e+"]").attr("checked","checked"),function(e){o("#section_head_category_icon").scrollTop(0);var a=o("#section_head_category_icon_group").find("input[value="+e+"]").parents("li").position();0!=a.top&&o("#section_head_category_icon").scrollTop(a.top)}(e)}}),o("#ekb-admin-page-wrap").find("[class$=pkb-menu-back]").on("click",function(e){o(".epkb-top-category-box").removeClass("epkb-category-selection-color"),o(".epkb-config-category-name").text("[ select category on the left ]"),o("#epkb-content-container").find("[id^=section_head_category_icon]").attr("disabled",!0)}),o("#epkb-main-page-settings").on("change","#section_head_category_icon",function(e){var a=o("#epkb-main-page-container").find(".epkb-category-selection-color").find(".epkb-cat-icon");if(0!==a.length){var t=e.target.value;a.removeClass(a.attr("data-kb-category-icon")),a.addClass(t),a.attr("data-kb-category-icon",t),function(){o("#epkb_save_categories_icons").val("icons-saved");var e=o("#epkb-content-container").find(".epkb-cat-icon").map(function(){return o(this).attr("data-kb-category-icon")+"="+o(this).parent().data("kb-category-id")}).get().join(".");o("#epkb_categories_icons").val(e)}()}}),o("#epkb-content-container").find("[id^=section_head_category_icon]").attr("disabled",!0),o(document).ajaxComplete(function(){clearTimeout(s),s=setTimeout(function(){a.find(".eckb-bottom-notice-message").addClass("fadeOutDown")},1e4),a.find(".eckb-bottom-notice-message").on("click",".epkb-close-notice",function(){o(this).parent().addClass("fadeOutUp")}),o(".epkb-config-sidebar, #mega-menu-main-page-layout").find(":radio").on("click",function(){w(o(this))}),o(".epkb-config-sidebar, #mega-menu-main-page-layout").find(":radio").each(function(){w(o(this))}),o("#templates_for_kb_group").find(":radio").on("click",function(){w(o(this))})}),o("#eckb-hidden-wp-editor-container")&&"undefined"!=typeof tinyMCE&&(tinyMCE.init({selector:"#sidebar_main_page_intro_text_eckb_editor"}),o("#epkb-main-page-settings").on("click","#eckb-wp-editor-update",function(){o("#eckb-hidden-wp-editor-container").addClass("eckb-popup").show()}),o("#eckb-hidden-wp-editor-container").on("click","#eckb-popup-ok-button",function(){o("#wp-sidebar_main_page_intro_text_eckb_editor-wrap").hasClass("html-active")&&o(".switch-tmce").trigger("click"),o("#eckb-hidden-wp-editor-container").removeClass("eckb-popup").hide();var e=void 0===o("#eckb-hidden-wp-editor-container").find("textarea").attr("id")?"":o("#eckb-hidden-wp-editor-container").find("textarea").attr("id");if(void 0!==tinyMCE.activeEditor&&0!=e.length){var a=tinyMCE.activeEditor.getContent(),t="#"+e.replace("_eckb_editor","");void 0!==o(t)&&(o(t).text(a),o(t).text(a)),p()}}),o("#eckb-hidden-wp-editor-container").on("click","#eckb-popup-cancel-button",function(){o("#eckb-hidden-wp-editor-container").removeClass("eckb-popup").hide()})),o(".epkb-config-container").on("click",".overview-toggle",function(e){o(this).parents(".overview-info-section").find(".overview-content").slideToggle()}),0<=window.location.search.toLowerCase().indexOf("ekb-main-page")&&o("#epkb-main-page").trigger("click")});